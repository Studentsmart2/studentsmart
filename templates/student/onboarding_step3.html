<!DOCTYPE html>
<html>
<head>
    <title>Onboarding Step 3 - Work Experience</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; max-width: 600px; margin: 50px auto; padding: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; }
        input, textarea { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 4px; }
        button { width: 100%; padding: 10px; background: #2563eb; color: white; border: none; border-radius: 4px; cursor: pointer; margin-top: 10px; }
        button:hover { background: #1d4ed8; }
        .exp-entry { border: 1px solid #ddd; padding: 15px; margin-bottom: 15px; border-radius: 4px; }
    </style>
</head>
<body>
    <h1>Step 3: Work Experience</h1>
    <p>Add your work experience (optional, can skip)</p>
    <div id="experienceList"></div>
    <button type="button" onclick="addExperience()">+ Add Experience</button>
    <button type="button" onclick="submitForm()">Next Step</button>

    <script>
        let expCount = 0;

        function addExperience() {
            expCount++;
            const div = document.createElement('div');
            div.className = 'exp-entry';
            div.innerHTML = `
                <div class="form-group">
                    <label>Company:</label>
                    <input type="text" id="company_${expCount}" required>
                </div>
                <div class="form-group">
                    <label>Position:</label>
                    <input type="text" id="position_${expCount}" required>
                </div>
                <div class="form-group">
                    <label>Description:</label>
                    <textarea id="desc_${expCount}" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label>Start Date:</label>
                    <input type="date" id="start_${expCount}">
                </div>
                <div class="form-group">
                    <label>End Date:</label>
                    <input type="date" id="end_${expCount}">
                </div>
            `;
            document.getElementById('experienceList').appendChild(div);
        }

        async function submitForm() {
            const experience = [];
            for (let i = 1; i <= expCount; i++) {
                const company = document.getElementById(`company_${i}`).value;
                if (company) {
                    experience.push({
                        company: company,
                        position: document.getElementById(`position_${i}`).value,
                        description: document.getElementById(`desc_${i}`).value,
                        start_date: document.getElementById(`start_${i}`).value,
                        end_date: document.getElementById(`end_${i}`).value
                    });
                }
            }

            const response = await fetch('/student/onboarding/step3', {
                method: 'POST',
                headers: {'Content-Type': 'application/json'},
                body: JSON.stringify({ experience })
            });
            const data = await response.json();
            if (data.success) {
                window.location.href = data.redirect;
            }
        }
    </script>
</body>
</html>
